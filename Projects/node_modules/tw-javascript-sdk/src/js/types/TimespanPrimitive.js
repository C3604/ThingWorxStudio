var TW = TW || {};
TW.SDK = TW.SDK || {};
TW.SDK.Types = TW.SDK.Types || {};

(function () {
    TW.SDK.Types.TimespanPrimitive = {
        decode: function(data) {
            TW.SDK.HelperFunctions.validateParameter(data, 'data', ArrayBuffer);

            var start = TW.SDK.Types.LongPrimitive.decode(data.slice(0, 8));
            var end = TW.SDK.Types.LongPrimitive.decode(data.slice(8, 16));
            var period = TW.SDK.Types.StringPrimitive.decode(data.slice(16));

            return {
                length: start.length + end.length + period.length,
                content: {
                    start: start.content,
                    end: end.content,
                    period: period.content
                }
            };
        },

        encode: function(content) {
            TW.SDK.HelperFunctions.validateParameter(content, 'content', 'object');

            var buffers = [];

            buffers.push(TW.SDK.Types.LongPrimitive.encode(content.start));
            buffers.push(TW.SDK.Types.LongPrimitive.encode(content.end));
            buffers.push(TW.SDK.Types.StringPrimitive.encode(content.period));

            _.flatten(buffers);

            return TW.SDK.HelperFunctions.combineArrayBuffers(buffers);
        },

        getDefaultValue: function() {
            return {
                start: 0,
                end: 0,
                period: "00:00:00:00:01:00"
            };
        }
    };
})();
