/* begin copyright text
 *
 * Copyright Â© 2016 PTC Inc., Its Subsidiary Companies, and /or its Partners. All Rights Reserved.
 *
 * end copyright text
 */
(function(twxAppBuilder) {

  function twxMap() {
    return {
      elementTag: 'twx-map',
      label: 'ves-basic-web-widgets-extension:Map',
      category: 'basic-html',
      isVisibleInPalette: false,
      properties: [
        {
          name: 'visible',
          label: 'ves-basic-web-widgets-extension:Visible',
          datatype: 'string',
          default: false,
          isBindingTarget: true
        },
        {
          name: 'height',
          label: 'ves-basic-web-widgets-extension:Height',
          datatype: 'number',
          default: 400,
          isBindingTarget: true
        },
        {
          name: 'locationsData',
          label: 'ves-basic-web-widgets-extension:Locations Data Source',
          datatype: 'infotable',
          default: [],
          isBindingTarget: true
        },
        {
          name: 'locationsField',
          label: 'ves-basic-web-widgets-extension:Locations Data Field',
          datatype: 'string',
          default: '',
          isBindingTarget: false,
          editor: 'select',
          fieldDefinitions: 'locationsData'
        },
        {
          name: 'mapCenterLong',
          label: 'ves-basic-web-widgets-extension:Map Center Long',
          datatype: 'number',
          default: 0,
          isBindingTarget: true
        },
        {
          name: 'mapCenterLat',
          label: 'ves-basic-web-widgets-extension:Map Center Lat',
          datatype: 'number',
          default: 0,
          isBindingTarget: true
        },
        {
          name: 'zoom',
          label: 'ves-basic-web-widgets-extension:Zoom',
          datatype: 'number',
          default: 10,
          isBindingTarget: true
        },
        {
          name: 'enableToolTips',
          label: 'ves-basic-web-widgets-extension:Enable Tooltips',
          datatype: 'boolean',
          isBindingTarget: true,
          default: false
        },
        {
          name: 'apiKey',
          label: 'ves-basic-web-widgets-extension:API Key',
          datatype: 'string',
          default: '',
          isBindingTarget: true
        },
        {
          name: 'centerLoc',
          label: 'ves-basic-web-widgets-extension:Center Location',
          datatype: 'location',
          default: '',
          isBindingTarget: true
        },
        {
          name: 'mapType',
          label: 'ves-basic-web-widgets-extension:Map Type',
          datatype: 'string',
          default: 'roads',
          editor: 'select',
          isBindingTarget: true,
          options: [
            {label: 'ves-basic-web-widgets-extension:Roads', value: 'roads'},
            {label: 'ves-basic-web-widgets-extension:Satellite', value: 'satellite'},
            {label: 'ves-basic-web-widgets-extension:Hybrid', value: 'hybrid'},
            {label: 'ves-basic-web-widgets-extension:Terrain', value: 'terrain'}
          ]
        },
        {
          name: 'autoZoom',
          label: 'ves-basic-web-widgets-extension:Auto Zoom Behavior',
          datatype: 'string',
          default: 'always',
          editor: 'select',
          options: [
            {label: 'ves-basic-web-widgets-extension:Always', value: 'always'},
            {label: 'ves-basic-web-widgets-extension:Never', value: 'never'},
            {label: 'ves-basic-web-widgets-extension:Inital Data', value: 'initial'},
            {label: 'ves-basic-web-widgets-extension:Data Refresh', value: 'refresh'}
          ]
        },
        {
          name: 'enableDrag',
          label: 'ves-basic-web-widgets-extension:Enable Drag',
          datatype: 'boolean',
          default: true,
          isBindingTarget: true
        },
        {
          name: 'margin',
          label: 'ves-basic-web-widgets-extension:Margin',
          datatype: 'string',
          default: ''
        }

      ],

      events: [
        {
          name: 'boundsChanged',
          label: 'ves-basic-web-widgets-extension:Bounds Changed'
        },
        {
          name: 'doubleClicked',
          label: 'ves-basic-web-widgets-extension:Double Clicked'
        }
      ],

      designTemplate: function(props) {
        return '<div class="mapContainer" style="height: {{me.height}}px; margin: {{me.margin}};">MAP<twx-container-content></twx-container-content></div>';
      },

      runtimeTemplate: function(props) {
        var tmpl = '<div style="height: {{me.height}}px; margin:'+ props.margin +';">' +
          '<div id="eventTrigger" ng-click="fireEvent();"></div>' +
          '<twx-map-widget map-height="' + props.height + '" enable-tool-tips="' + props.enableToolTips + '" enable-drag="' + props.enableDrag + '" api-key="' + props.apiKey + '" auto-zoom="' + props.autoZoom + '" data="{{me.locationsData}}" center-location="{{me.centerLoc}}" locations-field="' + props.locationsField + '" map-type-id="' + props.mapType + '" map-type="{{me.mapType}}" center-lat="' + props.mapCenterLat + '" center-long="' + props.mapCenterLong + '" zoom="{{me.zoom}}"></twx-map>' +
          '</div>';
        return tmpl;
      }
    }
  }

  twxAppBuilder.widget('twxMap', twxMap);

})(twxAppBuilder);