/* begin copyright text
 *
 * Copyright Â© 2016 PTC Inc., Its Subsidiary Companies, and /or its Partners. All Rights Reserved.
 *
 * end copyright text
 */
(function (twxAppBuilder) {
  var defaultText = 'Dropdown Label';
  try {
    defaultText = i18next.t('ves-basic-web-widgets-extension:Dropdown Label');
  }
  catch(e){
    //Running on the server
  }

  function twxSelect() {

    return {
      elementTag: 'twx-select',

      label: 'ves-basic-web-widgets-extension:Select',

      category: 'basic-html',

      properties: [
        {
            name: 'class',
            label: 'ves-basic-web-widgets-extension:Class',
            datatype: 'string',
            //default: '',
            isBindingTarget: true
        },
        {
          name: 'value',
          label: 'ves-basic-web-widgets-extension:Value',
          datatype: 'string',
          isBindingTarget: true,
          isBindingSource: true,
          default: ''
        },
        {
          name: 'list',
          label: 'ves-basic-web-widgets-extension:List',
          datatype: 'infotable',
          isBindingTarget: true
        },
        {
          name: 'valuefield',
          label: 'ves-basic-web-widgets-extension:Value Field',
          datatype: 'string',
          default: 'value'
        },
        {
          name: 'displayfield',
          label: 'ves-basic-web-widgets-extension:Display Field',
          datatype: 'string',
          default: 'display'
        },
        //{
        //  name: 'multiselect',
        //  label: 'ves-basic-web-widgets-extension:Multi-Select',
        //  datatype: 'boolean',
        //  default: false
        //},
        {
          name: 'label',
          label: 'ves-basic-web-widgets-extension:Label',
          datatype: 'string',
          default: defaultText
        },
        {
          name: 'visible',
          label: 'ves-basic-web-widgets-extension:Visible',
          datatype: 'boolean',
          default: true,
          isBindingTarget: true
        },
        {
          name: 'disabled',
          label: 'ves-basic-web-widgets-extension:Disabled',
          datatype: 'boolean',
          default: false,
          isBindingTarget: true
        },
        {
          name: 'itempadding',
          label: 'ves-basic-web-widgets-extension:List Item Padding',
          datatype: 'string',
          default: ''
        }
      ],

      events: [
        {
          name: 'change',
          label: 'ves-basic-web-widgets-extension:Value Changed'
        }
      ],

      designTemplate: function () {
        return '<div class="item item-input item-select {{me.class}}" style="padding:{{me.itempadding}};">' +
                      '<div class="input-label">' +
                        '{{me.label}}' +
                      '</div>' +
                      '<select>' +
                        '<option>{{me.valuefield}}</option>' +
                      '</select>' +
                    '</div>';
                    
      },

      runtimeTemplate: function (props) {
        var tmpl = '<div ng-show="app.fn.isTrue(me.visible)" class="ng-hide item item-input item-select {{me.class}}"  style="padding: '+ props.itempadding +';">' +
                      '<div class="input-label">' +
                        props.label +
                      '</div>' +
                      '<select ng-disabled="app.fn.isTrue(me.disabled)" ng-model="me.value" ng-change="app.fn.clickItemInSelect(me.list,me.multiselect,me.value,me.valuefield);fireEvent(\'change\')" >' +
                        '<option ng-repeat="item in me.list" class="item" value="{{item.' + props.valuefield + '}}">{{item.'+ props.displayfield +'}}</option>' +
                      '</select>' +
                    '</div>';
                    
        return tmpl;
      }
    }
  }

  twxAppBuilder.widget('twxSelect', twxSelect);

})(twxAppBuilder);