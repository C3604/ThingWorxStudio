/**
 * Do upgrade work for projects older than 1.4
 * @param {object} params - the same params given to onupgrade func + removeSync func
 * @param log - logs to console & upgrade.log
 */
function onupgrade(params, log) {
    if (params.settings.projectType === 'ar') {
        log.debug('Changing projectType from ar to AR');
        params.settings.projectType = 'AR';
    }
    if (params.settings.projectType === '2D') {
        log.debug('Changing projectType from 2D to AR');
        params.settings.projectType = 'AR';
    }
    log.debug('Remove all the src-scaffold files from src');
    ['/src/phone/app-runtime.js',
        '/src/templates/',
        '/src/themes/dark-theme-overrides.scss',
        '/src/themes/dark-theme-variables.scss',
        '/src/themes/ionic-theme-variables.scss',
        '/src/ionic/',
        '/src/phone/css/app.css',
        '/src/phone/css/ionic*',
        '/src/phone/css/themePreviewBase.css',
        '/src/phone/fonts/glyphicons-halflings-regular*',
        '/src/phone/fonts/ionicons*',
        '/src/phone/img/recognised.png',
        '/src/phone/img/recognised2.png',
        '/src/phone/_builder/',
        '/src/phone/lib/angular-google-chart/',
        '/src/phone/lib/bower-ng-twx-uicomponents/',
        '/src/phone/lib/cdn/',
        '/src/phone/lib/ionic/',
        '/src/phone/lib/http-auth-interceptor.js',
        '/src/phone/lib/twx-client-core-all.js',
        '/src/phone/lib/twx-connector.js',
        '/src/phone/lib/uuid.js',
        '/src/phone/tml/']
        .forEach(function(relativePath) {
            params.removeSync(relativePath);
        });
}

module.exports = {
    version: '1.3.0',
    range: '<1.3.0 || 1.3.x',
    onupgrade: onupgrade
};