/* begin copyright text
 *
 * Copyright Â© 2016 PTC Inc., Its Subsidiary Companies, and /or its Partners. All Rights Reserved.
 *
 * end copyright text
 */
(function(twxAppBuilder){

  function twxFixedPanel(){
    return {
      elementTag: 'twx-fixed-panel',

      label: 'ves-ar-extension:Fixed Panel',

      category: 'ionic-2D',

      isContainer: true,

      isVisibleInPalette: false,

      properties: [
        {
            name: 'class',
            label: 'ves-ar-extension:Class',
            datatype: 'string',
            isBindingTarget: true
        },
        {
          name: 'visible',
          label: 'ves-ar-extension:Visible',
          datatype: 'boolean',
          default: true,
          isBindingTarget: true
        }
      ],

      designTemplate: function(props){
        return '<div class="twx-fixed-panel {{me.class}}"><twx-container-content></twx-container-content></div>';
      },

      runtimeTemplate: function(props){
        var tmpl = '<div ng-show="app.fn.isTrue(me.visible)" class="ng-hide twx-fixed-panel {{me.class}}"><twx-container-content></twx-container-content></div>';
        return tmpl;
      },

      // Returns a delegate constructor
      delegate: function(){
        this.widgetAdded = function(widgetCtrl){
          console.log('widgetAdded');
          var widgetEl = widgetCtrl.element();
          widgetEl.css('top', widgetCtrl.getProp('top') + 'px');
          widgetEl.css('left', widgetCtrl.getProp('left') + 'px');
          widgetEl.draggable({
            stop: function(event, ui){
              console.log(ui);
              widgetCtrl.setProp('top', ui.position.top);
              widgetCtrl.setProp('left', ui.position.left);
            }
          });
        };

        this.widgetRemoved = function(){
          console.log('widgetRemoved');
        };

        this.widgetSelected = function(widgetCtrl){
          console.log('widgetSelected');
        };

        this.widgetUpdated = function(props){
          console.log('widgetUpdated');
          console.log(props);
        };

      }
    };
  }

  twxAppBuilder.widget('twxFixedPanel', twxFixedPanel);

})(twxAppBuilder);